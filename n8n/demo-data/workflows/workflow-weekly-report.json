{
  "name": "Weekly Report - Beauty Agent Insights",
  "description": "ë§¤ì£¼ ì›”ìš”ì¼ 9ì‹œì— ì£¼ê°„ í†µê³„ ë¦¬í¬íŠ¸ ìƒì„± ë° ì „ì†¡",
  "nodes": [
    {
      "id": "1",
      "type": "n8n-nodes-base.trigger",
      "position": [250, 300],
      "parameters": {
        "triggerType": "schedule",
        "interval": "weeks",
        "weeksInterval": 1,
        "triggerAtDayOfWeek": "monday",
        "triggerAtHour": 9,
        "triggerAtMinute": 0
      },
      "name": "Schedule Trigger"
    },
    {
      "id": "2",
      "type": "n8n-nodes-base.postgres",
      "position": [450, 300],
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT COUNT(*) as new_reviews, AVG(sentiment_score) as avg_sentiment, COUNT(DISTINCT product_number) as products_reviewed FROM reviews WHERE created_at >= NOW() - INTERVAL '7 days';"
      },
      "name": "Generate Weekly Stats"
    },
    {
      "id": "3",
      "type": "n8n-nodes-base.postgres",
      "position": [650, 300],
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT p.name, COUNT(r.id) as review_count, AVG(r.sentiment_score) as avg_score, MAX(r.registered_at) as latest_review FROM reviews r JOIN products p ON r.product_number = p.product_number WHERE r.created_at >= NOW() - INTERVAL '7 days' GROUP BY p.product_number, p.name ORDER BY review_count DESC LIMIT 5;"
      },
      "name": "Top Products This Week"
    },
    {
      "id": "4",
      "type": "n8n-nodes-base.openai",
      "position": [850, 300],
      "parameters": {
        "resource": "chat",
        "model": "gpt-4o-mini",
        "messages": {
          "messageUiValues": [
            {
              "role": "system",
              "content": "ë‹¹ì‹ ì€ ë·°í‹° ì‚°ì—… ë¶„ì„ê°€ì…ë‹ˆë‹¤.\në‹¤ìŒ ì£¼ê°„ í†µê³„ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì¸ì‚¬ì´íŠ¸ë¥¼ ìƒì„±í•˜ì„¸ìš”.\n\n3-5ê°œì˜ í•µì‹¬ ì¸ì‚¬ì´íŠ¸ë¥¼ markdown í˜•ì‹ìœ¼ë¡œ ì œì‹œí•˜ì„¸ìš”.\nì‹¤ì œ ìˆ«ìì™€ íŠ¸ë Œë“œë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”."
            },
            {
              "role": "user",
              "content": "ì£¼ê°„ ì‹ ê·œ ë¦¬ë·°: {{$json.new_reviews}}\ní‰ê·  ê°ì •ì ìˆ˜: {{$json.avg_sentiment}}\në¦¬ë·°ëœ ì œí’ˆ ìˆ˜: {{$json.products_reviewed}}\n\nTop 5 ì œí’ˆ:\n{{$json.topProducts}}"
            }
          ]
        },
        "temperature": 0.7
      },
      "name": "LLM Insights"
    },
    {
      "id": "5",
      "type": "n8n-nodes-base.slack",
      "position": [1050, 300],
      "parameters": {
        "operation": "post",
        "channelId": "#beauty-agent-logs",
        "text": "ğŸ“Š ì£¼ê°„ ë¦¬í¬íŠ¸ - {{$now}}\n\nâœ¨ í•µì‹¬ ì¸ì‚¬ì´íŠ¸:\n{{$json.message.content}}\n\nğŸ“ˆ í†µê³„:\n- ì‹ ê·œ ë¦¬ë·°: {{$json.new_reviews}}ê°œ\n- í‰ê·  ê°ì •ì ìˆ˜: {{$json.avg_sentiment}} / 5\n- ë¦¬ë·°ëœ ì œí’ˆ: {{$json.products_reviewed}}ê°œ"
      },
      "name": "Slack Report"
    }
  ],
  "connections": {
    "1": {
      "main": [[{"node": "2", "type": "main", "index": 0}]]
    },
    "2": {
      "main": [[{"node": "3", "type": "main", "index": 0}]]
    },
    "3": {
      "main": [[{"node": "4", "type": "main", "index": 0}]]
    },
    "4": {
      "main": [[{"node": "5", "type": "main", "index": 0}]]
    }
  },
  "active": false
}
